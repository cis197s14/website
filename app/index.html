<!DOCTYPE html>
<html>
  <head>
    <title>CIS 197 JavaScript</title>
    <meta charset="utf-8">
    <meta name="description" content="UPenn CIS 197 course website">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic,700italic|Montserrat:400,700|Inconsolata:400,700">
    <link rel="stylesheet" type="text/css" href="build/css/vendor/pure-min.css">
    <link rel="stylesheet" type="text/css" href="build/css/vendor/prism.css">
    <link rel="stylesheet" type="text/css" href="build/css/main.css">
  </head>
  <body>
    <div class="pure-g-r main-content index-page">
      <nav class="pure-u-1-8 pure-menu pure-menu-open">
        <div class="pure-menu-heading"><img id="logo" src="build/images/logo.png">
          <h2>CIS 197</h2>
        </div>
        <ul class="sections">
          <li class="home active"><a href="#home">Home</a></li>
          <li class="assignments"><a href="#assignments">Assignments</a></li>
          <li class="lectures"><a href="#lectures">Lectures</a></li>
          <li class="piazza"><a href="https://piazza.com/class/hpz2ie7jeo0sx" target="_blank">Piazza</a></li>
        </ul><small>&copy; 2014</small>
      </nav>
      <section class="pure-u-3-4 home active"><h2 id="javascript-spring-2014-">JavaScript (Spring 2014)</h2>
<h3 id="intro-to-front-end-web-development">Intro to Front End Web Development</h3>
<p>Course meets <strong>Wednesday 1:30pm – 3:00pm</strong> in <strong>Towne 337</strong>.</p>
<p>Instructor: <strong>Adi Dahiya</strong> (adahiya@seas)</p>
<p>TAs:</p>
<ul>
<li><strong>Kyle Hardgrave</strong> (kyleh@seas)</li>
<li><strong>Greg Terrono</strong> (gterrono@seas)</li>
</ul>
<p>Office hours: See <a href="https://piazza.com/upenn/spring2014/cis197/staff">Piazza staff page</a></p>
<h3 id="course-description">Course Description</h3>
<p>This course provides an introduction to modern web development frameworks,
techniques, and practices used to deliver robust client side applications on
the web. The emphasis will be on developing JavaScript programs that run in
the browser, <em>not</em> server-side applications in traditional languages like Java,
Python, or Ruby. See the <a href="#lectures">lecture schedule</a> for more info.</p>
<p>This course is most useful for students who have some programming and web
development experience and want to develop moderate JavaScript skills to be
able to build complex, interactive applications in the browser.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>CIS 120 or equivalent (or permission of instructor).</li>
<li>Basic knowledge of HTML/CSS (if you don&#39;t meet this requirement, you are
expected to pick up the basics on your own with online resources like
<a href="http://codecademy.com">Codecademy</a> and
<a href="https://developer.mozilla.org/en-US/">Mozilla Developer Network</a>).</li>
</ul>
<h3 id="policies">Policies</h3>
<p>Extensions on homework assignments will generally be granted if you ask for
them in advance. Assignments come with the opportunity for revision up to a
week after grading. <strong><em>See the
<a href="https://docs.google.com/document/d/1vd7qfE4TGTG_FW8LIACFIGMcBb1JQwQ0YofMwMyCyjc">course syllabus</a>
for more detailed policies and grading info</em></strong>.</p>

      </section>
      <section class="pure-u-3-4 assignments"><h2 id="assignments">Assignments</h2>
<p>Assignments are due <strong>at 9am</strong> unless otherwise indicated.
Code submissions are to be made using the Github submission system.
Refer to the <a href="#style">style guide</a> for coding JavaScript.</p>
<p>hw0: <a href="#github">Set up Github submission</a>.</p>
<p>hw1, due <strong>Wed, Feb. 5</strong>: <a href="https://github.com/cis197s14/hw/blob/master/hw1/exercises.js">Finger exercises</a>.</p>
<p>hw2, due <strong>Fri, Feb 14</strong>: <a href="#hw2">XML object modeling</a>.</p>
<p>hw3, due <strong>Fri, Feb. 21</strong>: jQuery mini-project.</p>
<p>hw4, due <strong>Fri, Feb. 28</strong>: Basic Backbone.js app.</p>
<p>hw5, due <strong>Wed, March 19</strong>: Intermediate Backbone.js app.</p>
<p>hw6, due <strong>Wed, April 2</strong>: Advanced Backbone.js app.</p>
<p>hw7, due <strong>Wed, April 9</strong>: Final project proposal.</p>
<h2 id="final-project">Final Project</h2>
<p>The final project will be an open-ended JavaScript application created with
client-side framework of the student&#39;s choice. It should demonstrate 10-15
hours of work. The tentative due date is <strong>April 30</strong> (last day of classes).</p>
<p>A <strong><em>proposal</em></strong> outlining your project idea and plan for execution is due on
<strong>April 9</strong>. More information (including ideas for final projects) will be
available in April.</p>

      </section>
      <section class="pure-u-3-4 lectures"><h2 id="lectures">Lectures</h2>
<p><strong>Code samples</strong> from lectures are available in
<a href="https://github.com/cis197s14/lectures">this Github repository</a>.</p>

        <table>
          <thead>
            <tr>
              <td>Week</td>
              <td>Lecture</td>
              <td>Content</td>
              <td>Reading, Resources</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>1/22</td>
              <td>
                <a href="#lecture1">
                  JS basics & syntax <br/>
                  How to run JS client-side and server-side
                </a>
              </td>
              <td>
                Eloquent JS, Chapter 2 <br/>
                <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript">
                  [MDN] A re-introduction to JavaScript
                </a>
                
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>1/29</td>
              <td><a href="#js-functions">JS functions</a></td>
              <td>Eloquent JS, Chapters 3</td>
            </tr>
            <tr>
              <td>3</td>
              <td>2/5</td>
              <td>
                <a href="#objects">JS objects & inheritance</a> <br/>
                <a href="#browsers">JS in browsers</a>
              </td>
              <td>
                <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript">
                  [MDN] Introduction to Object-Oriented JavaScript
                </a> <br/>
                <a href="https://developer.mozilla.org/en-US/docs/DOM">
                  [MDN] Document Object Model
                </a> <br/>
                Eloquent JS, Chapters 12
                
              </td>
            </tr>
            <tr>
              <td>4</td>
              <td>2/12</td>
              <td>
                Manipulating the DOM with jQuery <br/>
                Webkit developer tools & debugging
              </td>
              <td>
                Eloquent JS, Chapter 13 <br/>
                <a href="https://developers.google.com/chrome-developer-tools/">
                  Chrome DevTools docs
                </a>
                
              </td>
            </tr>
            <tr>
              <td>5</td>
              <td>2/19</td>
              <td>
                Functional Programming with Underscore.js <br/>
                Introduction to client-side MVC
              </td>
              <td>
                Eloquent JS, Chapter 6 <br/>
                <a href="http://dailyjs.com/2012/09/14/functional-programming/">
                  [DailyJS] Functional Programming in JS
                </a> <br/>
                DBA: Intro, Fundamentals
                
              </td>
            </tr>
            <tr>
              <td>6</td>
              <td>2/26</td>
              <td>
                A deeper dive into Backbone.js <br/>
                AJAX requests, JSON data <br/>
                RESTful applications, routing
              </td>
              <td>DBA: RESTful Persistence, Events, Routers</td>
            </tr>
            <tr>
              <td>7</td>
              <td>3/5</td>
              <td>Introduction to Node.js <br/></td>
              <td>Node Beginner Book</td>
            </tr>
            <tr>
              <td>–</td>
              <td>3/12</td>
              <td><em>No class: Spring Break</em></td>
              <td>–</td>
            </tr>
            <tr>
              <td>8</td>
              <td>3/19</td>
              <td>
                Creating an entire web application in JS <br/>
                (Backbone.js + Node.js + MongoDB)
              </td>
              <td>DBA: Exercise 2</td>
            </tr>
            <tr>
              <td>9</td>
              <td>3/26</td>
              <td>
                Best practices for client-side apps <br/>
                Backbone.js extentions (MarionetteJS) <br/>
                Common problems &amp; solutions
              </td>
              <td>
                Eloquent JS Chapter 9 <br/>
                DBA: Backbone Extensions, Common Problems & Solutions
                
              </td>
            </tr>
            <tr>
              <td>10</td>
              <td>4/2</td>
              <td>
                HTML5 features <br/>
                (Canvas, local storage, audio/video, app cache, offline)
              </td>
              <td></td>
            </tr>
            <tr>
              <td>11</td>
              <td>4/9</td>
              <td>
                Debugging front end performance <br/>
                Build systems &amp; tools
              </td>
              <td></td>
            </tr>
            <tr>
              <td>12</td>
              <td>4/16</td>
              <td>
                Introduction to other client-side frameworks <br/>
                (AngularJS, Ember, React)
              </td>
              <td></td>
            </tr>
            <tr>
              <td>13</td>
              <td>4/23</td>
              <td><em>Special Topics</em>: WebSockets</td>
              <td>
                <a href="https://developer.mozilla.org/en-US/docs/WebSockets">
                  [MDN] WebSockets
                </a> <br/>
                <a href="http://socket.io/">Socket.io library</a>
                
              </td>
            </tr>
            <tr>
              <td>14</td>
              <td>4/30</td>
              <td><em>Special Topics</em>: Compile-to-JS languages</td>
              <td>
                <a href="http://coffeescript.org/">CoffeeScript</a> <br/>
                <a href="http://www.typescriptlang.org/">TypeScript</a>
                
              </td>
            </tr>
          </tbody>
        </table><h2 id="reading">Reading</h2>
<ul>
<li><a href="http://www.amazon.com/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742"><em>JavaScript: The Good Parts</em></a> – Douglas Crockford</li>
<li><a href="http://eloquentjavascript.net/"><em>Eloquent JavaScript</em></a> – Marijn Haverbeke</li>
<li><a href="http://addyosmani.github.io/backbone-fundamentals/"><em>Developing Backbone.js Applications</em></a> (DBA) – Addy Osmani</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript"><em>Mozilla Developer Network JS Articles</em></a></li>
</ul>

      </section>
      <section class="pure-u-3-4 notes github language-bash"><h1 id="cis197-code-submission">CIS197 Code Submission</h1>
<p>CIS 197 (January 22, 2013)</p>
<p><em>Adapted from <a href="http://www.seas.upenn.edu/~cis192/spring2013/submission/hwsubmission.html">CIS 192</a></em>.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Mac or Linux environment. Windows works too, but some commands will be
different and you are responsible for figuring out the differences.</li>
<li>Git installed in your development environment &amp; some basic knowledge of git
commands. If you need to boost your git skills, try
<a href="http://help.github.com/">Github help</a>, <a href="http://try.github.io/">Try Git</a>, <a href="http://gitimmersion.com/">Git
Immersion</a>, and/or
<a href="http://marklodato.github.io/visual-git-guide/index-en.html">A Visual Git Reference</a>.</li>
<li>A <a href="http://github.com">Github</a> account. Feel free to use the one you have
already.</li>
</ul>
<h3 id="setup">Setup</h3>
<p><em>Note</em>: This system is still in beta. If you encounter errors in this guide or
the course website, please post a private <a href="https://piazza.com/class/hpz2ie7jeo0sx">Piazza</a>
question. If you have a question about Git or Github, please post a public
question.</p>
<ol>
<li><p>Complete the <a href="https://docs.google.com/forms/d/1ldp1D0eU4ZBYM_X12Qyloy_ZPJD9jWv6ClguegiJ5L4/viewform">intro survey</a>
if you haven&#39;t already. Once you get an email
saying you have been added to the <strong>cis197s14</strong> organization, you may proceed
with the next steps.</p>
</li>
<li><p>Log onto Github. Change your view to the CIS 197 class context.
<img src="build/images/github/context.png" alt="switch context"></p>
</li>
<li><p>Click on the repository we&#39;ve created for your homework. The name will be in
the format <strong>&quot;hw_pennkey&quot;</strong>. Note this repository is private; only you and
the instructors have access to it.
<img src="build/images/github/repo-name.png" alt="repo name"></p>
</li>
<li><p>Copy the repository url from its page.
<img src="build/images/github/repo-url.png" alt="repo url"></p>
</li>
<li><p>Open your terminal. You&#39;re going to clone a copy of this repository so that
you can do work on it and push updates back to Github. First <code>cd</code> into the
directory you want the homework folder in (if you don&#39;t know what that means,
please take a few minutes to read Section 3 of <a href="http://heather.cs.ucdavis.edu/~matloff/UnixAndC/Unix/UnixBareMn.pdf">this document</a>. Now execute:</p>
<pre><code> git clone repo_url_you_copied
</code></pre><p>put together, that all looks like</p>
<pre><code> bash-3.2 $ cd ~/Github/cis197/

 bash-3.2 $ git clone https://github.com/cis197s14/hw_cis197bot.git
 Cloning into &#39;hw_cis197bot&#39;...
 Username for &#39;https://github.com&#39;: cis197bot
 Password for &#39;https://cis197bot@github.com&#39;:
 warning: You appeared to have cloned an empty repository.
 Checking connectivity... done.
 bash-3.2 $
</code></pre><p>You&#39;ve now copied the (empty) repository onto our computer, so you can go into
that directory:</p>
<pre><code> bash-3.2 $ cd hw_cis197bot
</code></pre></li>
<li><p>Now you&#39;re going to add the class homework repository as an &quot;upstream&quot; to our
personal homework repository. This will allow you to pull required homework
files directly from Github. You&#39;ll need to execute the following command
inside the directory you just cloned:</p>
<pre><code> git remote add upstream https://github.com/cis197s14/hw.git
</code></pre><p>This added the class repository as a git &quot;remote&quot;, which means that you can
pull changes down from that repository and into your personal repository.
Let&#39;s do that now. Run the command:</p>
<pre><code> git pull upstream master
</code></pre><p>and you should see that files were copied from the server.</p>
</li>
<li><p>Almost done. You need to create a git branch where your code will be
submitted. First, create a new branch called &quot;submit&quot;:</p>
<pre><code> git branch submit
</code></pre><p>Now push that branch to Github:</p>
<pre><code> git push origin submit
</code></pre><p>And also push the master branch to Github:</p>
<pre><code> git push origin master
</code></pre></li>
</ol>
<p>Great! Now that the setup is done, you can get started on homework.</p>
<h3 id="working-on-homework">Working on homework</h3>
<ol>
<li><p>First, get any files/folders that were added to the class homework
repository:</p>
<pre><code> git pull upstream master
</code></pre></li>
<li><p>Now complete your assignment. Please make sure to create a different folder
in the repository for each homework assignment (<code>hw1</code>, <code>hw2</code>, etc.)</p>
</li>
<li><p>Here&#39;s how you commit to the repository and push the work to Github. Let&#39;s
say you wrote code in two files, <code>file1.js</code> and <code>file2.js</code>, in the directory
<code>hw1</code> inside your homework repository. First you need to stage all the
relevant files:</p>
<pre><code> git add hw1/file1.js hw1/file2.js
</code></pre><p>Now make a commit:</p>
<pre><code> git commit -m &quot;done with hw1&quot;
</code></pre><p>Push changes to Github:</p>
<pre><code> git push origin master
</code></pre></li>
<li><p>Now your homework files are on Github. All you need to do now is create
a pull request to complete the submission. Go to your homework repository and
create a new Pull Request from the Pull Requests tab.
<img src="build/images/github/pull-request.png" alt="pull request"></p>
</li>
<li><p>Set up a pull request with the base branch set as &quot;submit&quot;, and finally send
it.
<img src="build/images/github/send-pull.png" alt="send pull"></p>
</li>
</ol>
<p>Do not click the &quot;Merge Pull Request&quot; button on Github after your submission (a
TA will do that after grading homework). Though we require that you <em>submit</em>
your homework with git, it would be wise to use git to keep track of your
changes before you submit.</p>
<h3 id="notes">Notes</h3>
<ul>
<li>If you don&#39;t want to type your password every time you try to push or pull
from Github, see the documentation on <a href="https://help.github.com/articles/set-up-git#password-caching">password caching</a>.</li>
<li>Feel free to work on a branch other than <code>master</code> (if you know what that
means), but please make pull requests against the <code>submit</code> branch.</li>
</ul>

      </section>
      <section class="pure-u-3-4 notes lecture1 language-javascript"><h1 id="lecture-1-intro-js-basics">Lecture 1: Intro &amp; JS Basics</h1>
<p>CIS 197 (January 22, 2013)</p>
<h2 id="intro">Intro</h2>
<p>As a browser scripting language, one of JavaScript&#39;s main uses is to implement
view logic -- how a user interface on the web is drawn, manipulated, and
interacted with. But as the language has matured, its scope has widened. Today,
you can do things like build a web server in JavaScript using Node.js or compile
video games from C++ to JS using Emscripten to play Quake III in a browser.</p>
<p>A few years ago, the traditional workflow of the front end developer was to get
some JS (probably jQuery) code working locally, FTP it over to a server, and
then handle the myriad cross-browser compatibility issues that ensued (*cough*
IE6 *cough*). The past few years have seen somewhat of a transformation of the
front end dev role, with a much greater emphasis on tools and practices. It&#39;s
a result of:</p>
<ul>
<li>people taking front end more seriously,</li>
<li>browsers getting MUCH better,</li>
<li>and more programmers with traditional programming experience entering the
ecosystem</li>
</ul>
<p>One of my goals in this class is to introduce you to modern tools, practices,
and workflows in front end development. There&#39;s a sort of
<a href="http://rmurphey.com/blog/2012/04/12/a-baseline-for-front-end-developers/">baseline</a>
of things that you&#39;re expected to be familiar with (Node, npm, homebrew, git,
tests, build systems, etc.) in order to be successful and not feel left behind.
I&#39;ll talk more about this at the end of today&#39;s lecture.</p>
<p>Today, I&#39;m going to talk about language basics like syntax and variable scoping
and there won&#39;t be much mention of the web. As a programming language, JS is
an implementation of the ECMAScript standard, which makes no reference to web
technology. We&#39;re currently on v5 of ECMAScript, with v6 expected to be
a significant expansion to the language due in 2014.</p>
<h2 id="language-basics">Language Basics</h2>
<p>See <a href="#js-basics">JS basics module</a>.</p>
<h2 id="exercises">Exercises</h2>
<p>Using these basics, can you write out a Fizzbuzz program?</p>
<p>Solution:</p>
<pre><code>for (var i = 0; i &lt; 15; i++) {
  if (i % 3 === 0 &amp;&amp; i % 5 === 0) {
    console.log(&quot;fizzbuzz\n&quot;);
  } else if (i % 3 === 0) {
    console.log(&quot;fizz\n&quot;);
  } else if (i % 5 === 0) {
    console.log(&quot;buzz\n&quot;);
  } else {
    console.log(i + &quot;\n&quot;);
  }
}
</code></pre><h2 id="homework">Homework</h2>
<p>Most of your homework will be to get up to speed with the tools you need for
front end development.</p>
<p>The first important thing you&#39;re expected to know is <strong>git</strong> version control.
Using version control allows you to collaborate on software projects and
participate in the rich open-source community (JS is the most popular language
on Github!) To boost your git skills, use online resources like:</p>
<ul>
<li><a href="http://help.github.com/">Github help</a></li>
<li><a href="http://try.github.io/">Try Git</a></li>
<li><a href="http://gitimmersion.com/">Git Immersion</a></li>
<li><a href="http://marklodato.github.io/visual-git-guide/index-en.html">A Visual Git Reference</a></li>
</ul>
<p>For this class, I also expect a basic to moderate understanding of HTML/CSS. If
you are lacking in this area, please use online resources like
<a href="http://codecademy.com">Codecademy</a> and
<a href="https://developer.mozilla.org/en-US/">Mozilla Developer Network</a>.</p>
<p>The rest of your homework is as follows:</p>
<ul>
<li>Read the <em>entire</em> <a href="https://docs.google.com/document/d/1vd7qfE4TGTG_FW8LIACFIGMcBb1JQwQ0YofMwMyCyjc">syllabus</a>.</li>
<li>Download Google Chrome (optionally, Chrome Canary).</li>
<li>Install the latest version of node.js (on OS X, I recommend using Homebrew).</li>
<li>Set up a Github account &amp; fill out the
<a href="https://docs.google.com/forms/d/1ldp1D0eU4ZBYM_X12Qyloy_ZPJD9jWv6ClguegiJ5L4/viewform">intro survey</a>.</li>
<li>Complete the <a href="#github">code submisison tutorial</a>.</li>
</ul>

      </section>
      <section class="pure-u-3-4 notes js-basics language-javascript"><h1 id="javascript-basics">JavaScript Basics</h1>
<p>Reference: <strong><em>Eloquent JavaScript</em></strong> and <strong><em>JavaScript: The Good Parts</em></strong>.</p>
<p><a href="#lecture1">&larr; Back to Lecture 1</a></p>
<h3 id="introduction">Introduction</h3>
<blockquote>
<p>JavaScript is a programming language being used to do all sorts of clever and
horrible things on the web.</p>
</blockquote>
<p>-- Marijn Haverbeke, EloquentJS</p>
<p>It&#39;s the world&#39;s most widely available application runtime. It runs in all
modern web browsers and is one of the easiest languages to start using since you
don&#39;t have to download anything. Even if you don&#39;t do much web programming,
which this course focuses on, I hope I&#39;ll be able to expose you to some
interesting (or even mind-boggling) programs that influence how you write good
code in other languages and platforms. The good parts of JS (as Douglas
Crockford points out) really make it a great functional language -- deep down,
it actually shares more with Lisp and Scheme than C or Java (even though it
looks like C or Java on the surface).</p>
<p>You might have heard a great deal of criticism about JS coming into the course
(I&#39;m sure I did when I first picked up JS). When you first start writing
programs, you&#39;ll notice that it&#39;s very liberal in what it allows. However, what
you type might end up being interpreted very differently from what you imagined.
Consider this seemingly basic arithmetic with various types:</p>
<pre><code>1 + &#39;2&#39;        // --&gt; &#39;12&#39;
[] + 4         // --&gt; &#39;4&#39;
[] - 4         // --&gt; -4
{} + 4         // --&gt; &#39;[object Object]4&#39;
</code></pre><p>Sure, it might seem weird that we&#39;re adding together arrays, objects, and numbers
(where other languages would throw type errors), but you somewhat get the idea.</p>
<p>This kind of weak dynamic typing accounts for much of the language&#39;s
flexibility, but can also be troubling for beginners since the interpreter won&#39;t
help you identify all errors. On the flip side, it allows for many techniques
that are impossible in more strict languages. By learning the language properly
and working with it for a while, I&#39;ve grown to really like JS -- you might too!</p>
<h3 id="getting-started">Getting Started</h3>
<p>We&#39;re going to learn JavaScript by reading, writing, and running code. Like
I said, JavaScript usually runs in a browser, but it also runs on a platform
called <code>node.js</code>, which is built on Google Chrome&#39;s V8 JavaScript runtime. We&#39;ll
talk more about <a href="http://nodejs.org/">Node</a> later in the course, but for now I&#39;ll
just use it as a JS interpreter and runtime to run code snippets.</p>
<p>You can fire up a REPL (interactive interpreter) simply with the <code>node</code> command.
If you don&#39;t have Node and want to follow along, you can use
<a href="http://repl.it/languages/JavaScript">repl.it</a>. (JS code can also be written to
a <code>.js</code> file and run with <code>node</code>). Alternatively, you can simply open up the
console in your web browser and type expressions:</p>
<p><img src="build/images/browser-console.png" alt="browser-console"></p>
<p>Ready? Let&#39;s start by looking at the different kinds of values in JS.</p>
<h3 id="values">Values</h3>
<p><strong>Number</strong>: only one type, written literally.</p>
<ul>
<li>Internally, stored as a 64-bit double (like Java <code>double</code>)</li>
<li><code>NaN</code> represents not a number, where a value did not produce a result</li>
<li><p><code>Infinity</code> represents all numbers greater than (roughly) <code>1.8e308</code></p>
<pre><code>  2 + (4 * -3)  // --&gt; -10
  1.25e4        // --&gt; 12500
</code></pre></li>
</ul>
<p><strong>String</strong>: written with single quotes or double quotes. Use single quotes.</p>
<ul>
<li>Escape values with backslash <code>&quot;\n \t \\&quot;</code></li>
<li>Insert Unicode character codes with <code>\u</code></li>
<li>Can be compared with <code>&lt;</code>, <code>&gt;</code> (roughly alphabetical)</li>
<li><p>Strings are immutable, but easy to concatenate with <code>+</code></p>
<pre><code>  &quot;abc&quot; + &quot;def&quot;         // --&gt; &quot;abcdef&quot;
  4 + &quot; is a number&quot;    // --&gt; &quot;4 is a number&quot;
  &quot;abacus&quot; &lt; &quot;aardvark&quot; // --&gt; false
</code></pre></li>
<li><p>No <code>char</code> type means you must use a single-char string</p>
</li>
<li>Each character is 16 bits wide</li>
<li>Access length with <code>.length</code> property (there are a few other String methods,
discussed later)</li>
</ul>
<p><strong>Boolean</strong>: <code>true</code>, <code>false</code></p>
<ul>
<li><p>Standard operators: <code>&amp;&amp;</code>, <code>||</code>, <code>!</code></p>
<pre><code>  true &amp;&amp; !false  // --&gt; true
</code></pre></li>
</ul>
<p><em>A note about <em>falsy</em> values</em>: The following values, when evaluated as Booleans,
are false:</p>
<ul>
<li><code>false</code></li>
<li><code>null</code></li>
<li><code>undefined</code></li>
<li>The empty string <code>&#39;&#39;</code></li>
<li>The number <code>0</code></li>
<li>The number <code>NaN</code></li>
</ul>
<p>All <em>other</em> values, including <code>true</code>, the string <code>&#39;false&#39;</code>, and all objects, are
<strong><em>truthy</em></strong>. Control flows like this are common:</p>
<pre><code>var course = {
  title: &#39;JavaScript&#39;,
  dept: &#39;CIS&#39;,
  code: 197
};

if (course.instructor) {
  console.log(course.instructor.name);
} else {
  console.error(&quot;No instructor found!&quot;);
}
</code></pre><p><strong>Object</strong>: curly braces (really convenient literal notation!)</p>
<ul>
<li>Lightweight mutable key-value stores</li>
<li>Like C structs, Python dicts, associative arrays, etc.</li>
<li><p>Accessed with <code>.propertyName</code> or <code>[&#39;propertyName&#39;]</code> refinement syntax</p>
<pre><code>  var obj = {
    number: 1,
    string: &quot;abcdef&quot;,
    bool: true,
    object: { a: 1, b: 2, c: 3 },
    function: (function () { return 0; })
  }

  obj.string        // --&gt; &quot;abcdef&quot;
  obj[&#39;object&#39;].a   // --&gt; 1
</code></pre></li>
<li><p>Under the hood, pretty much everything is represented as an object in JS
(more on this later)</p>
</li>
</ul>
<p><strong>Array</strong>: square brackets literal notation.</p>
<ul>
<li>Hash map performance</li>
<li>Internally represented as objects with numerical property names: <code>arr[0]</code></li>
<li><p>Convenience methods like <code>.push</code>, <code>.pop</code>, <code>.join</code></p>
<pre><code>  var a = [ &#39;this&#39;, &#39;is&#39;, &#39;a&#39;, &#39;list&#39;, &#39;of&#39;, &#39;tokens&#39; ]

  a[0]          // --&gt; &#39;this&#39;
  a.join(&#39; &#39;)   // --&gt; &#39;this is a list of tokens&#39;
</code></pre></li>
</ul>
<p><strong>Function</strong>: <code>function</code> keyword + curly braces contain block of statements.</p>
<ul>
<li>First-class JS object (this allows JavaScript to be highly <em>functional</em>)</li>
<li>&quot;Piece of a program wrapped in a value&quot;</li>
<li><p>Returns a value provided with <code>return</code> keyword, otherwise <code>undefined</code></p>
<pre><code>  var square = function (x) {
    return x * x;
  }

  Math.square = square;

  console.log(&quot;the square of 4 is &quot; + Math.square(4));
</code></pre></li>
</ul>
<p><strong>Undefined</strong>: void, null, un-assigned-to variables.</p>
<pre><code>var x;                    // --&gt; undefined
var f = function () { };
f();                      // --&gt; undefined
</code></pre><p>Values are garbage collected by the JS runtime (no <code>malloc</code>, etc. like in C).</p>
<p>Let&#39;s examine some more language grammar &amp; terminology...</p>
<h3 id="expressions">Expressions</h3>
<p><strong>Expressions</strong> are anything that produces a value:</p>
<ul>
<li>Literally written values (string, number, built-in)</li>
<li>Expression within parentheses</li>
<li>Unary operator applied to one expression (<code>-</code>, <code>!</code>, <code>typeof</code>, ...)</li>
<li>Binary operator applied (infix) to two expressions (<code>+</code>, <code>*</code>, <code>===</code>, <code>&amp;&amp;</code>, ...)</li>
<li>Ternary operator applied to three expressions
(<code>predicate ? valueIfTrue : valueIfFalse</code>)</li>
<li>Object refinement (using <code>[&#39;propertyName&#39;]</code> or <code>.propertyName</code>)</li>
<li>Invocation</li>
</ul>
<p>Expressions cannot have side effects, meaning they cannot affect state of the
program or the world. They <em>only</em> produce a value.</p>
<h3 id="statements">Statements</h3>
<p>JavaScript programs are built as a list of statements. Each is typically
terminated by a semicolon <code>;</code> (C-style syntax). You can also sequence
statements with <code>,</code> but let&#39;s not have any of that in this course.</p>
<p>Programs are executed sequentially statement-by-statement from top to bottom;
you can guarantee order of execution.</p>
<h3 id="programs">Programs</h3>
<p>A JavaScript file contains a program. You can run multiple files at the same
time and they will share a common global environment. There is no built-in
module system in ECMAScript (coming soon in v6), but we will discuss later how
you can properly organize your code to achieve the kinds of module or package
systems you might be familiar with from other programming languages.</p>
<p>In a browser environment, each <code>&lt;script&gt;</code> tag loads a compilation unit and
executes the contained code immediately. Here we encounter one of the <strong>bad
parts</strong> of JavaScript: reliance on global variables.</p>
<p>JavaScript lacks a linker (like <code>C</code>), so when it interprets a compilation unit,
it throws all variables together into a common global namespace &amp; scope.</p>
<h3 id="variable-scoping">Variable Scoping</h3>
<p>We&#39;ve seen a few variables in the above examples; let&#39;s look at them more
closely. You declare variables simply with the <code>var</code> keyword (look ma, no
static types!).</p>
<p>Variables exist in an environment and can one of two scopes:</p>
<ul>
<li>Global</li>
<li>Function</li>
</ul>
<p>The rule for distinguishing the two is actually pretty simple: variables
declared outside of a function definition are <strong>global</strong> while those inside are
<strong>local</strong>.</p>
<p>Local variables are created and destroyed every time a function is run (which
is often just once; we&#39;ll see how this is exploited).</p>
<p><em>Variables are evaluated as if they were declared at the top of the scope they
exist in</em>. This is referred to as <strong><em>hoisting</em></strong>. Take a look at this buggy
program:</p>
<pre><code>var a = 100;
show();

function show () {
  console.log(a);    // --&gt; &quot;undefined&quot;

  if (true) {
    var a = 123;
  }
}
</code></pre><p>Why does line 5 print &quot;undefined&quot;?</p>
<p>Before JavaScript executes a function, it looks for all variable declarations
within the current scope. It then declares all those variables <em>but doesn&#39;t
assign them</em> (effectively executing the statement <code>var a;</code>). Only then does
the function block get executed. Assignment of a variable occurs when the
function execution reaches the line where you actually assign a variable.</p>
<p>In the example above, <code>a</code> is re-declared as a local variable at the top of the
<code>show</code> function. So when we try to print out its value with <code>console.log</code>, its
value is undefined.</p>

      </section>
      <section class="pure-u-3-4 notes js-functions language-javascript"><h1 id="javascript-functions">JavaScript Functions</h1>
<p>Reference: <strong><em>Eloquent JavaScript</em></strong> and <strong><em>JavaScript: The Good Parts</em></strong>.</p>
<hr>
<blockquote>
<p>Generally, the craft of programming is the factoring of a set of requirements
into a set of functions and data structures.</p>
</blockquote>
<p>-- Douglas Crockford (<em>JS: The Good Parts</em>)</p>
<p>I won&#39;t too talk about the data structures, but let&#39;s examine the basics of what
a <em>function</em> does in a programming language. Functions embody the logic of your
application.</p>
<p>Pure functions have no side effects -- they don&#39;t affect the state of the world.
They are easy to use and reason about since they require no context, and they
are also more widely applicable to solving problems through code. However, they
do not solve all the possible problems you might come across when developing
software. I did say, of course, that JS is mainly used for view logic on the
web; if we can&#39;t manipulate the state of a web page, then what good is our
program?</p>
<p>This next bit of advice applies to nearly all programming languages: if
a function seems simple enough that it can be written <em>purely</em>, then do so. In
terms of programming language theory, JavaScript borrows a lot from functional
languages, so it would be wise (and more natural to the language) to remain
thinking functionally, trying to keep as much of the impure application logic
contained to a few modules.</p>
<p>One more thing: like I said earlier, nearly everything in JS is an object, and 
that includes functions as well. They have a few special things about them,
including invocation capabilities. We&#39;ll cover more of the nuances of the
function object later.</p>
<h3 id="invocation">Invocation</h3>
<p>In addition to its arguments (which are <em>immediately</em> defined as variables),
a function receives two extra special variables in its context: <code>this</code> and
<code>arguments</code>.</p>
<p><code>this</code> refers to the containing scope or context of a function invocation:</p>
<p><strong>Method Invocation</strong>: when invoked as a property of an object, a function&#39;s
containing object is its context.</p>
<pre><code>var myObject = {
  value: 0,
  increment: function (inc) {
    inc = inc ? inc : 1;
    this.value += inc;
  }
}

myObject.increment();
myObject.increment(50);
console.log(myObject.value);  // --&gt; 51
</code></pre><p><strong>Function Invocation</strong>: functions not invoked as an object property are
attached to the global object; this is somewhat of a flaw in JavaScript&#39;s
design. This flaw is best demonstrated by example.</p>
<p>Let&#39;s say I wanted to augment <code>myObject</code> with a <code>double</code> method
which doubles the contained <code>value</code> property. And maybe I&#39;d like to use a
helper function to encode this logic, like so:</p>
<pre><code>myObject.double = function () {
  var helper = function () {
    this.value = this.value * 2;
  };

  helper();
};

myObject.double();
console.log(myObject.value);  // --&gt; 51
</code></pre><p>But this doesn&#39;t work! <code>myObject.value</code> has not been doubled; <em>function
invocation</em> is the reason why. Even though the <code>helper</code> function is being
defined within a method of <code>myObject</code>, it gets executed in the global context.
As a result, <code>this</code> within <code>helper</code> references the global context (where the 
<code>value</code> property is meaningless).</p>
<p>The solution ends up being a strange construction like the following.
Functions don&#39;t retain a reference to their parent <code>this</code>, so we must manually
keep a reference, usually called <code>that</code>:</p>
<pre><code>myObject.double = function () {
  var that = this;

  var helper = function () {
    that.value = that.value * 2;
  };

  helper();
};

myObject.double();
console.log(myObject.value);  // --&gt; 102
</code></pre><p><strong>Constructor Invocation</strong>: when a function invocation is proceeded by the <code>new</code>
keyword, a new object is created and the function&#39;s <code>this</code> scope is bound to
that new object. This is strongly tied to prototypical inheritance, which is
covered in the notes on <strong>objects</strong>.</p>
<p><strong>Apply Invocation</strong>: because they&#39;re just objects, functions can have their own
methods as well (crazy, I know). One in particular that&#39;s useful is the <code>.apply</code>
method, which allows you to specify a <code>this</code> context and <code>arguments</code> list.</p>
<pre><code>var anotherObject = {
  value: -10
}

myObject.increment.apply(anotherObject, [5]);

console.log(anotherObject.value)  // --&gt; -5
</code></pre><p><em>Related</em>: <strong>Call Invocation</strong>: works almost the same as the <code>.apply</code> method, but
instead of using an array, you pass arguments directly:</p>
<pre><code>myObject.increment.call(anotherObject, 5);
</code></pre><h3 id="closures">Closures</h3>
<p>Because of the limited types of variable scoping available in JS, hiding private
variables might seem difficult at first. But as as is often the case in the
language, the incredible flexibility of functions comes to the rescue.</p>
<p>A <strong>closure</strong> in JavaScript is a function that, when invoked, is able to use
variables not available in the current scope -- they were stored in the closure
by the function that generated it. Here&#39;s a simple example.</p>
<pre><code>var genClosure = function () {
  var privateUser = {
    firstName: &#39;Adi&#39;
  , lastName: &#39;Dahiya&#39;
  };

  var printName = function () {
    console.log(privateUser.firstName + &#39; &#39; + privateUser.lastName);
  };

  return printName;
}

console.log(genClosure());    // --&gt; &#39;Adi Dahiya&#39;
</code></pre><p>Here, the global environment doesn&#39;t have access to the <code>privateUser</code> variable,
but the function returned from <code>genClosure</code> is still able to access it. You&#39;ll
see this immediately in any code intended for execution in Node: it will be
wrapped in an <strong>Immediately-Invoked Function Expression</strong> (IIFE).</p>
<h3 id="iife">IIFE</h3>
<p>We know by now that global variables in JavaScript are a <em>Bad Thing</em>. Luckily,
JS programmers have developed a pattern to mitigate this concern. An
immediately-invoked function expression is an anonymous function used at the top
level of a JS program to <em>provide a lexical scope for just that file / module</em>.
It looks like this:</p>
<pre><code>(function () {

  var Person = function () { ... };
  Person.prototype.getDescription = function () { ... };
  ...

  module.exports = {
    Person: Person,
    ...
  };

})();
</code></pre><p>What we&#39;ve done here is define an anonymous function and immediately invoked it
so that the contained code is run immediately when the file is loaded. The use
of a function makes any an all <code>var</code> declarations scoped to the anonymous
function, <em>not the global context</em>.</p>
<p>Note the exports exposed by this module at the end of the IIFE. <em>This is an
instance of a closure!</em>. When another file (or the Node interpreter) imports
this module, it can use any properties or functions from the <code>exports</code> object,
but it can&#39;t access the rest of the variables in the IIFE scope. Specifically,
this example uses <strong>AMD</strong> (asynchronous module definition) syntax, which is the
standard in Node.js.</p>

      </section>
      <section class="pure-u-3-4 notes style language-javascript"><h2 id="code-style">Code Style</h2>
<p>Code style is extremely important when developing code that you hope to last
longer than its first writing. This is especially important with JavaScript
because the interpreter is very tolerant and will allow a great deal of
syntactic mistakes to pass undetected when code is executed. JS developers must
exhibit great discipline in writing idiomatic code that is easily readable to
all other developers.</p>
<p>Because of this, we&#39;re going to be adhering to a style guide for code written in
this class. If you ever go out and write JavaScript professionally, you would do
well to adhere to a structured style guide as well.</p>
<p><strong>Indentation</strong>: use spaces, not tabs. 2 or 4 spaces.</p>
<p><strong>Line Length</strong>: avoid lines longer than 80 characters.</p>
<p><strong>Comments</strong>: be generous with comments, but try to describe more about <em>why</em>
a function exists and the assumptions it makes rather than <em>how</em> it does things.
JavaScript is an expressive enough language (with first class functions, etc.)
that you can write very readable code that expresses intent properly.</p>
<p><strong>Whitespace</strong>: most tokens should be separated by whitespace. Declare functions
like this:</p>
<pre><code>var parseInt = function (string, radix) {
  ...
};
</code></pre><p><code>if / else</code> blocks and <code>for</code> / <code>while</code> loops should always be split into lines,
as per the K&amp;R standard:</p>
<pre><code>if (predicate) {
  ...
} else {
  ...
}


for (var i = 0; i &lt; len; i++) {
  ...
}


while (condition) {

}
</code></pre><p><strong>Functions</strong></p>
<p>If you use an identifier with a function expression, it provides the added
benefit of showing up with a proper identifier in stack traces.</p>
<pre><code>var parseInt = function parseInt (string, radix) {
  ...
};
</code></pre><p>Alternatively, you can use a <em>function definition</em> syntax like the following
example, but keep in mind that scoping works slightly differently – this
function becomes available at the top of its scope while the above <em>function
expression</em> syntax means that a function is only available when its expression
is evaluated (and stored to that variable).</p>
<pre><code>function parseInt (string, radix) {
  ...
};
</code></pre><p><strong>Operators</strong></p>
<p>Avoid doing assignments in the conditional of <code>if</code> and <code>while</code> statements:</p>
<pre><code>if (a = b) {
</code></pre><p>...looks like a statement where intent can easily be misinterpreted as</p>
<pre><code>if (a === b) {
</code></pre><p><code>eval</code> is evil and misused. Don&#39;t use it in your programs. It has aliases, so
avoid those as well. Don&#39;t use the <code>Function</code> constructor or pass strings to
<code>setTimeout</code> / <code>setInterval</code>.</p>
<p>Similarly, <code>with</code> <a href="http://yuiblog.com/blog/2006/04/11/with-statement-considered-harmful/">should not be used</a>.</p>
<hr>
<p>Finally, you should be including an IIFE in all your JavaScript files (to
avoid polluting the global namespace), along with a <code>&#39;use strict&#39;</code> statement,
which invokes stricter interpretation of your JS source
(<a href="http://www.webdesignporto.com/why-use-strict-in-javascript-can-save-you-hours/">here&#39;s a more detailed explanation</a>).</p>
<pre><code>// file.js
(function () {
  &#39;use strict&#39;;

  // do stuff


  module.exports = {
    // export stuff
  };
})();
</code></pre><p><strong><em>For a very detailed style guide, refer to
<a href="https://github.com/rwaldron/idiomatic.js/">idiomatic.js</a>.</em></strong> (I generally
agree with most of the conventions used there).</p>

      </section>
      <section class="pure-u-3-4 notes objects language-javascript"><h1 id="javascript-objects">JavaScript Objects</h1>
<p>Reference: <strong><em>Eloquent JavaScript</em></strong> and <strong><em>JavaScript: The Good Parts</em></strong>.</p>
<hr>
<p>Objects are the building block of any consequential JS program -- you&#39;ll need to
understand them intimately to write good code. All JS values that are not simple
types (numbers, strings, booleans, undefined) are objects.</p>
<p>There are no classes or static types in JS, so there are very few constraints on
property names and values. Objects can contain other objects, so you can easily
represent trees or graphs.</p>
<p>There is one slightly tricky feature of objects, and that is prototypical
inheritance. As the name suggests, it&#39;s similar to class-based (or classical)
inheritance. (More on this later).</p>
<p>As we&#39;ve seen, there&#39;s a convenient literal notation for objects:</p>
<pre><code>var flight = {
  airline: &quot;Oceanic&quot;,
  number: 815,
  departure: {
    IATA: &quot;SYD&quot;,
    time: &quot;2004-09-22 14:55&quot;,
    city: &quot;Sydney&quot;,
    &quot;gate-number&quot;: 17
  },
  arrival: {
    IATA: &quot;LAX&quot;,
    time: &quot;2004-09-23 10:42&quot;,
    city: &quot;Los Angeles&quot;,
    &quot;gate-number&quot;: &quot;46A&quot;
  },
};
</code></pre><p>When a property name is not a legal JS name (contains dashes or is a reserved
word), it requires quotes (like <code>&quot;gate-number&quot;</code> above). Similarly, in retrieval,
you must sometimes use the brackets refinement syntax (less preferred than the
<code>.</code> refinement syntax):</p>
<pre><code>var prop = &quot;gate-number&quot;;

flight.departure.city               // &quot;Sydney&quot;
flight.departure[&quot;gate-number&quot;]     // 17
flight.arrival[prop]                // &quot;46A&quot;
</code></pre><p>Attempts to access an undefined property will give you, as you might expect,
<code>undefined</code>. If you try to further access a property within this undefined
property, JavaScript will throw a (strangely-named) <code>TypeError</code>.</p>
<pre><code>flight.equipment        // undefined
flight.equipment.model  // TypeError: Cannot read property &#39;model&#39; of undefined
</code></pre><p>Property updates work just like variable assignment. Objects are always passed
around by reference; they are never copied (you might write a function to do
this manually).</p>
<p>The <code>delete</code> keyword removes a property from an object without touching anything
on the prototype chain:</p>
<pre><code>delete flight.number
</code></pre><h3 id="uses-patterns">Uses / Patterns</h3>
<p>The simplicity of objects means that they are widely used in various situations
to manage data.</p>
<ul>
<li><p>When an function takes in many arguments, it can be tricky to remember their
exact ordering, especially since there are no static types. Instead of a long
list of arguments, pass in a single object containing all the necessary data:</p>
<pre><code>var courseModel = mkCourse(&#39;JavaScript&#39;, &#39;CIS&#39;, 197, instructor, 20);

var courseModel = mkCourse({
name: &#39;JavaScript&#39;,
  dept: &#39;CIS&#39;,
  code: 197,
  instructor: instructor,
  enrollment: 20
});
</code></pre></li>
<li><p>JavaScript Object Notation (JSON) is a lightweight data format used
universally in web programming these days (it&#39;s cleaner / more lightweight
than SOAP, XML, etc.).  JSON allows a subset of the object syntax used in
JavaScript. That is to say, all JSON data is a valid JS object, but not all
JS objects are valid JSON. It&#39;s common to fetch JSON data with an AJAX request
and use it in a client-side application like so:</p>
<pre><code>var courseData = $.get(&#39;http://www.penncoursereview.com/CIS/197&#39;);

console.log(courseData);    // { name: &#39;JavaScript&#39;, dept: &#39;CIS&#39;, ... }
</code></pre></li>
<li><p>Arrays are actually just objects with some syntactic sugar and extra methods.
They look like this:</p>
<pre><code>var a = [ &#39;a&#39;, &#39;b&#39;, &#39;c&#39; ];

{
  0: &#39;a&#39;,
  1: &#39;b&#39;,
  2: &#39;c&#39;
}
</code></pre><p>So when you&#39;re using an Array, you&#39;re really using an object. Keep this in
mind when thinking about prototypes and inheritance.</p>
</li>
<li><p><em>Global abatement</em>. When you consider the problems associated with global
scoping of variables in JS, you might be thinking -- how do I share
application state across all my files if I want to avoid global variables?
It&#39;s fairly accepted practice to create a <em>single</em> global object variable that
you share between files and which maintains this state. It&#39;s kind of like
namespacing:</p>
<pre><code>// Globals!
MY_APP = {
  appId: &#39;asdf43f349hukjasdf9843&#39;,
  appSecret: &#39;shhh&#39;
};
</code></pre></li>
</ul>
<h3 id="prototypical-inheritance">Prototypical Inheritance</h3>
<p>All objects are linked to their <em>prototype</em>, an object from which they can
inherit properties. Those created as object literals are linked to
<code>Object.prototype</code> (built into the language).</p>
<p>When you attempt to retrieve an object property, JS will walk up the prototype
chain until it finds a matching property name (known as <em>delegation</em>).</p>
<p>Prototypes are <strong>dynamic</strong>: changing or adding a property on one will make it
immediately available to all objects that are linked to it.</p>
<ul>
<li>The Array methods you access when dealing with arrays (like <code>join</code>, <code>push</code>,
<code>pop</code>) are stored in the global <code>Array.prototype</code> rather than every instance
of an Array.</li>
<li><p>You can do some powerful things by updating a built-in prototype...</p>
<pre><code>var a = [ &#39;a&#39;, &#39;list&#39;, &#39;of&#39;, &#39;tokens&#39; ]
  , b = [ &#39;this&#39;, &#39;is&#39; ];

// Concatenates another array to the end of this one. Although this method
// is defined after a and b are initialized, they &quot;inherit&quot; the method.
Array.prototype.concat = function (other) {
  this.push.apply(this, other);
};

b.concat(a);
console.log(b.join(&#39; &#39;));     // --&gt; &#39;this is a list of tokens&#39;
</code></pre></li>
</ul>
<p>(<em>Note</em>: in hindsight, there&#39;s actually a built-in method called
  <code>Array.prototype.concat</code> already. So you wouldn&#39;t want to overwrite it like
  this.)</p>
<ul>
<li><p>And also some dangerous things! Let&#39;s say we wanted to swap the names of <code>pop</code>
and <code>shift</code>, which remove an element from the tail and head of an Array,
respectively:</p>
<pre><code>var old_pop = Array.prototype.pop;

Array.prototype.pop = Array.prototype.shift;
Array.prototype.shift = old_prop;
</code></pre><p>With this last bit of code, if you loaded anyone else&#39;s JS code (like the
jQuery library, etc.), any code that relies on <code>Array.prototype.pop</code> or
<code>Array.prototype.shift</code> wouldn&#39;t work properly. <strong>Lesson</strong>: be careful with
global prototypes.</p>
</li>
</ul>
<p><strong><em>Keep in mind</em></strong>: The delegation of properties sometimes creates problems
when you are only concerned with the immediate object in question (for
reflection or enumeration). In this case, it&#39;s helpful to use the
<code>hasOwnProperty</code> function available to all objects:</p>
<pre><code>for (prop in flight) {
  if (flight.hasOwnProperty(prop)) {
    console.log(prop + &quot;: &quot; + flight[prop]);
  }
}
</code></pre><p>There&#39;s actually another way to solve this problem by being more specific about
what type of property you are defining. The <code>Object.defineProperty</code> method lets
you set a property on an object and <em>configure</em> it with a few parameters,
including whether the property is enumerable, writable, etc. See
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">its documentation</a>.</p>
<pre><code>Object.defineProperty(flight, &#39;toString&#39;, {
  enumerable: false,
  value: function () { ... },
  writable: false
});
</code></pre><p><em>Note</em>: you are not guaranteed the order of properties with a <code>for in</code> loop on
objects. If you are really concerned with enumerating the properties in order,
it&#39;s best to list them out manually in an array:</p>
<pre><code>var categories = [
      &#39;cold&#39;
, &#39;hot&#39;
    , &#39;espresso&#39;
    ]
, coffeeProducts = {
      cold: [ &#39;iced&#39;, &#39;cold brew&#39; ]
, hot: [ &#39;pour over&#39;, &#39;french press&#39;, &#39;drip&#39; ]
    , espresso: [ &#39;americano&#39;, &#39;macchiato&#39;, &#39;shot&#39; ]
    };

for (var i = 0; l = categories.length; i &lt; l; i++) {
  var prop = categories[i];
  console.log(coffeeProducts[prop]);
}
</code></pre><h3 id="pseudo-classes">Pseudo-classes</h3>
<p>JavaScript is slightly conflicted about the nature of its inheritance, so its
constructor syntax makes it seem somewhat classical. You will see many objects
created with the <code>new</code> keyword:</p>
<pre><code>var a = new Array(16);

var americano = new Coffee({
  type: &#39;espresso&#39;
, variations: [ &#39;hot&#39;, &#39;iced&#39; ]
, preparation: &#39;Pull two espresso shots and pour them into a mug of water...&#39;
};
</code></pre><p>The <code>new</code> keyword essentially tells the runtime to <strong>invoke the <code>constructor</code>
method from a function&#39;s prototype</strong>.</p>
<p>Before we further inspect how constructors work, let&#39;s consider what happens in
the JS runtime when a function is created (they&#39;re objects too, after all).</p>
<p>When <strong>a function object is created</strong>, the internal <code>Function</code> constructor that
produces the function object runs some code like this:</p>
<pre><code>this.prototype = { constructor: this }
</code></pre><p>This behavior seems somewhat strange. Why do we need regular ol&#39; functions to
have constructors associated with them? Only those functions that actually
construct class-like objects should behave like this, right? Here we encounter
one of the flaws in the way JS does inheritance. <em>JavaScript doesn&#39;t
discriminate whether functions are meant to be constructors</em>. This means that
you as a programmer ought to demarcate constructors yourself through naming
conventions (capitalize the first letter of the function name).</p>
<p>When JS runs a line of code invoking the <code>new</code> keyword, some additional code
gets run after <code>this.prototype = { constructor: this }</code>. Note that <code>this</code>
represents the constructor function being invoked):</p>
<pre><code>var that = Object.create(this.prototype),
    other = this.apply(that, arguments);

if (typeof other === &#39;object&#39; &amp;&amp; other !== null) {
  return other;
} else {
  return that;
}
</code></pre><p>The method <code>Object.create</code> (see
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create">documentation</a>)
simply creates a new empty object with its <code>prototype</code> set to a provided value.
Then the constructor function is applied to the new object with proper arguments
forwarded. If the constructor returned a value, that value is returned as the
newly constructed object. Otherwise, the new object from <code>Object.create</code> is
returned.</p>
<p>Knowing this, we can write some pseudoclassical code like this:</p>
<pre><code>var Person = function (first, last, email) {
  this.firstName = first;
  this.lastName = last;
  this.email = email;
};

Person.prototype.getName = function () {
  return this.firstName + &quot; &quot; + this.lastName;
};

Person.prototype.getEmail = function () {
  return this.email;
};
</code></pre><p>The <code>Person.prototype</code> object now looks something like a class definition:</p>
<pre><code>{
  constructor: function (first, last, email) { ... },
  getName: function () { ... },
  getEmail: function () { ... }
}
</code></pre><p>A <code>Person</code> object would behave like so:</p>
<pre><code>var adi = new Person(&#39;Adi&#39;, &#39;Dahiya&#39;, &#39;adahiya@seas.upenn.edu&#39;);
console.log(adi.getName());       // --&gt; &quot;Adi Dahiya&quot;
</code></pre><p>And let&#39;s say we wanted to inherit from this <code>Person</code> &quot;class&quot;:</p>
<pre><code>var Instructor = function (first, last, email, course) {
  this.firstName = first;
  this.lastName = last;
  this.email = email;
  this.course = course;
};

Instructor.prototype = new Person();

Instructor.prototype.getDescription = function () {
  var name = this.getName();
  return name + &quot; teaches &quot; + this.course;
};

var adi = new Instructor(&#39;Adi&#39;, &#39;Dahiya&#39;, &#39;adahiya@seas.upenn.edu&#39;, &#39;CIS 197&#39;);
console.log(adi.getDescription());  // --&gt; &quot;Adi Dahiya teaches CIS 197&quot;
</code></pre><p>A couple things to note:</p>
<ul>
<li>The <code>Instructor</code> constructor has to re-do the work of the <code>Person</code>
constructor. Can you think of a way we can reuse the logic in <code>Person()</code> with
some clever function application?</li>
<li>I didn&#39;t set <code>Instructor.prototype = Person.prototype</code>. This would
have allowed <code>Instructor</code> access to the <code>Person</code> methods, but it would have
also made it a two-way relationship, where any methods added to
<code>Instructor.prototype</code> are also available to all <code>Person</code> instances, which we
<em>don&#39;t</em> want. By instantiating a new <code>Person</code> object, we get the benefits of
its prototype while maintaining separation.</li>
</ul>
<hr>
<p>We seem to be getting somewhere now! This behavior looks kinda object-oriented,
doesn&#39;t it? But there are some wonky things going on.</p>
<ul>
<li>The inheritance and &quot;class&quot; definition syntax looks weird because of the use
of <code>prototype</code> everywhere.</li>
<li>All properties are public.</li>
<li>You can&#39;t access the <code>super</code> method.</li>
</ul>
<p>Also, as I indicated above, there is some danger in defining a constructor like
this. What would happen if you forgot the <code>new</code> keyword when trying to use
a constructor? (hint: how are functions regularly invoked?)</p>
<p>Again, this design flaw in JavaScript is mitigated by capitalizing the first
letter of constructor functions. The hope is that a programmer reading the code
can easily identify missing <code>new</code> keywords.</p>
<p>As for the flaws mentioned above:</p>
<ul>
<li>There are limited alternatives for object-oriented programming that do not use
the <code>prototype</code> syntax like this. Compile-to-JS languages (which we may cover
later in the course) provide some great syntactic sugar that abstracts away
this kind of low-level class definition.</li>
<li>Use closures in your JS modules to maintain private variables.</li>
<li>If you set up the classes right, you can use something like
<code>Person.prototype.getName(...)</code> to access &quot;super&quot; methods.</li>
</ul>
<h3 id="object-create">Object.create</h3>
<p>In ES5 (the current JS standard), there was a new method introduced called
<code>Object.create</code>, which provides some simple syntax for <strong>differential
inheritance</strong>. Its first argument is the prototype of the object you want to
inherit from (or <code>null</code>), and the second (optional) argument is map of
properties you want to set on the new object.</p>
<p>Another way to express the above <code>Instructor</code> class using <code>Object.create</code>:</p>
<pre><code>var Instructor = function (first, last, email, course) {
  Person.apply(this, arguments);
  this.course = course;
};

Instructor.prototype = Object.create(Person.prototype);

Instructor.prototype.getDescription = function () {
  var name = this.getName();
  return name + &quot; teaches &quot; + this.course;
};
</code></pre><p>This accomplishes the earlier goal of separating <code>Instructor</code> and <code>Person</code>&#39;s
prototype (there&#39;s a level of indirection since <code>Object.create</code> produces a new
object) while also invoking the <code>super</code> constructor.</p>
<p>Both this and the above method (in the section &quot;Pseudo-classes&quot;) for
object-oriented programming in JavaScript are acceptable. The <code>Object.create</code>
method slightly reduces the number of lookups on the prototype chain when
invoking &quot;class&quot; methods.</p>
<hr>
<p><strong>Here&#39;s a real world example</strong> of inheritance from the
<a href="https://github.com/cis197s14/website/blob/master/app/assets/javascripts/main.js">source code</a>
for the CIS 197 website. Note that the actual code in the repository is compiled
from Coffeescript, not hand-written (but you&#39;ll notice the compiler produces
very readable code!).</p>
<pre><code>/*
* Manages state of the section-navigation functionality in the sidebar.
*/
var SectionNav = (function () {

  SectionNav.ACTIVE_CLASS = &#39;active&#39;;   // why can we do this up here?

  function SectionNav (target) {
    this.selected = &#39;&#39;;
    this.target = target;
    this.sections = this.target.children(&#39;section&#39;);
    ...
  };

  SectionNav.prototype.navigateTo = function (sectionName) {
    this.sections.removeClass(SectionNav.ACTIVE_CLASS);
    this.target.children(&quot;.&quot; + sectionName).addClass(SectionNav.ACTIVE_CLASS);

    this.nav.children().removeClass(SectionNav.ACTIVE_CLASS);
    this.nav.find(&quot;.&quot; + sectionName).addClass(SectionNav.ACTIVE_CLASS);
    this.selected = sectionName;
  }

  ...

  return SectionNav;

})();
</code></pre>
      </section>
      <section class="pure-u-3-4 notes browsers language-javascript language-html"><h1 id="javascript-in-the-browser">JavaScript in the browser</h1>
<p>Reference: <strong><em>Eloquent JavaScript</em></strong> &amp; <strong><em>Mozilla Developer Network</em></strong>.</p>
<hr>
<blockquote>
<p>The browser is a really hostile programming environment.</p>
</blockquote>
<p>-- Douglas Crockford, <em>The JavaScript Programming Language</em> (video lecture)</p>
<p>The web browser is actually a great place that&#39;s experienced a huge deal of
development in the past few years (again, this is correlated with an influx of
front end dev tooling). But this quote does have a nugget of truth to it, as
you&#39;ll experience yourself in writing JS for the browser.</p>
<p>The reason that web APIs and browsers have been able to advance quickly is that
their development has been relatively decentralized. There is a standardizing
body, but there is no central authority developing browsers and implementing
language features. Various browser vendors (Google, Mozilla, Microsoft, etc.)
have implemented features at different rates and this has made cross-browser
support somewhat haphazard.</p>
<h2 id="what-is-a-browser-">What is a browser?</h2>
<p>A web browser has two main components that allow you to view and interact with
web pages:</p>
<ul>
<li><strong>JavaScript engine</strong>: loads &amp; interprets JavaScript source code in
a sandboxed runtime. Can also implement extensions to the language.</li>
<li><strong>Rendering engine</strong> (or layout engine, or simply browser engine): formats
information on the page after parsing HTML &amp; CSS.</li>
</ul>
<p>Here are the major <a href="http://en.wikipedia.org/wiki/JavaScript_engine">JS engines</a>
and <a href="http://en.wikipedia.org/wiki/Comparison_of_web_browser_engines">rendering engines</a>, 
respectively:</p>
<ul>
<li><strong>v8</strong> + <strong>Blink</strong> (Google Chrome)</li>
<li><strong>SpiderMonkey / Rhino</strong>  + <strong>Gecko</strong> (Mozilla Firefox)</li>
<li><strong>Nitro</strong> + <strong>WebKit</strong> (Apple Safari)</li>
<li><strong>Chakra</strong> + <strong>Trident</strong> (Internet Explorer)</li>
</ul>
<p>There are even sometimes differences in the core JavaScript runtime across
browsers. For example, IE&#39;s runtime is known to have a memory leak when
a circular reference is retained between a user-created object and a built-in
object (such as a DOM reference).</p>
<p>Most of the development in these engines has been concerning performance.
Mozilla, generally the leader in cutting-edge JS research, has released JS
engines fast enough to run
<a href="https://blog.mozilla.org/blog/2013/03/27/mozilla-is-unlocking-the-power-of-the-web-as-a-platform-for-gaming/">3D games like Quake at 60fps in the browser</a>.</p>
<h3 id="a-bit-of-syntax">A bit of syntax</h3>
<p>Before going further, let&#39;s recall what a basic HTML document looks like:</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;CIS 197 JavaScript&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Welcome to CIS 197&lt;/h1&gt;
    &lt;p&gt;
      This is a course about ...
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>In my examples, I&#39;ll usually eschew the <code>&lt;doctype&gt;</code>, <code>&lt;html&gt;</code>, <code>&lt;body&gt;</code>, etc.
tags and write a simplified version of the page.</p>
<h2 id="loading-javascript-in-the-browser">Loading JavaScript in the browser</h2>
<p>Well, we&#39;re not quite at the level of developing browser games right now. Let&#39;s
first understand how JS is loaded in the browser environment.</p>
<p>Web browser programs differ fundamentally from most other programs you are used
to writing in some key ways that have nothing to do with the JavaScript
language. First off, think about what you&#39;re actually doing when you download
JavaScript from the Internet to your web browser and executing it -- you&#39;re
trusting source code from a huge number of websites of varying degrees of
well-meaning to run on your computer. Sounds dangerous, doesn&#39;t it?</p>
<p>But we all get off just fine on the web, don&#39;t we? This is largely due to a neat
little concept called <strong><em>sandboxing</em></strong>. Browsers severely limit the scope of
capabilities that a JavaScript program can act on. It can&#39;t look at the files on
your computer, modify things outside of the web page it&#39;s embedded in, or
contact servers other than the one which served its web page.</p>
<hr>
<p>Just like in a Node.js runtime, JS is executed in a global context, except this
time it&#39;s called <code>window</code>. It represents the current session in your browser
tab, which is cleared with every page refresh. That means your browser requests
new JS files and starts up a new global context when you switch or reload pages.</p>
<p>There are a few ways to invoke JS in an HTML page:</p>
<ul>
<li><p>Inline <code>&lt;script&gt;</code> tag</p>
<pre><code>&lt;head&gt;
  &lt;title&gt;...&lt;/title&gt;
  &lt;script&gt;
    alert(&quot;foo&quot;);
  &lt;/script&gt;
&lt;/head&gt;
</code></pre></li>
<li><p>Linked <code>&lt;script&gt;</code> tag</p>
<pre><code>&lt;head&gt;
  &lt;title&gt;...&lt;/title&gt;
  &lt;script type=&quot;text/javascript&quot; src=&quot;scripts/foo.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
</code></pre></li>
<li><p>Attached as an event handler to a DOM element</p>
<pre><code>&lt;button class=&quot;submit&quot; onclick=&quot;myApp.submitFormAsync();&quot;&gt;
  Submit
&lt;/button&gt;
</code></pre></li>
</ul>
<p>The first two methods result in the JS code being parsed &amp; run immediately as
the browser engine encounters it (while parsing the HTML document), while the
last (as indicated) runs some bit of JS code as an event callback.</p>
<p><em>Note</em>: It&#39;s good practice to load your <code>&lt;script&gt;</code> tags as late as possible in
the HTML. This way, your browser displays a (possibly functioning)
correctly-rendered HTML document with CSS before using precious CPU cycles on
parsing and interpreting JavaScript code. Also, avoid inline script tags in
favor of linked <code>.js</code> files. These files should be loaded at the end of
<code>&lt;body&gt;</code>:</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head ... &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Welcome to CIS 197&lt;/h1&gt;
    ...

    &lt;script type=&quot;text/javascript&quot; src=&quot;scripts/foo.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;scripts/bar.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>There&#39;s no convenient way to load multiple scripts at once like this; you&#39;ll
simply have to link all of them. But as we&#39;ll see later, various tools allow you
to package your application into a single script, which is usually also good
practice.</p>
<h2 id="document-object-model">Document Object Model</h2>
<p>Web pages structure is modeled using the Document Object Model, or DOM for
short. We know that HTML is a heirarchical markup language, so it makes sense
for our DOM to be a tree data structure.</p>
<p><img src="http://eloquentjavascript.net/img/html.png" alt="DOM tree"></p>
<p><em>Source</em>: Eloquent JavaScript</p>
<p>In the above diagram we can see the two main kinds of DOM nodes:
<em>regular nodes</em> and <em>text nodes</em>. Regular nodes are those with angle brackets in
HTML markup <code>&lt; &gt;</code> and text nodes are simply inline strings (for example, the
content of a <code>&lt;p&gt;</code> tag.</p>
<p>The root of an HTML document is available as a global variable in the browser JS
runtime called <code>document</code> -- this is the starting point for locating any other
node in the tree. There are a number of properties available on nodes; explore
them in a browser console and/or the
<a href="https://developer.mozilla.org/en-US/docs/DOM/DOM_Reference">MDN DOM Reference</a>.</p>
<pre><code>document.body;

var firstNode = document.body.firstChild;

if (firstNode.nodeType === 3) {
  // Text node
  console.log(&quot;First node contains text: &quot; + firstNode.nodeValue);
} else {
  // Regular node
  var n = firstNode.childNodes.length;
  console.log(&quot;First node has the tag &lt;&quot; + firstNode.nodeName + &quot;&gt; and
  &quot; + n + &quot; child nodes&quot;);
}
</code></pre><p>So far what we&#39;ve observed is an <em>application programming interface</em> for an HTML
document. Our web browser did the work to parse the DOM and model it for us. Can
we write a function that does the opposite (given a DOM node, print out its
HTML and the HTML of its children)?</p>
<pre><code>var isTextNode = function (node) {
      return node.nodeType === 3;
}
  , withBrackets = function (str, isClosing) {
      if (isClosing) {
        return &quot;&lt;&quot; + str.toLowerCase() + &quot;/&gt;&quot;;
      } else {
        return &quot;&lt;&quot; + str.toLowerCase() + &quot;&gt;&quot;;
      }
  };

var toHTML = function (node) {
  if (isTextNode(node)) {

    return node.nodeValue;        // TODO: escape HTML

  } else {

    var buffer = withBrackets(node.nodeName)
      , len = node.childNodes.length;

    if (len) {
      for (var i = 0; i &lt; len; i++) {
        buffer += toHTML(node.childNodes[i]);
      }

      buffer += withBrackets(node.nodeName, true);
    }

    return buffer;
  }
};

console.log(toHTML(document.body));
</code></pre><p>This is a neat little implementation, but it turns out there&#39;s a built-in
function with pretty similar (and more robust) functionality. The <code>outerHtml</code> 
property on DOM nodes returns a string of the HTML representation of a node
(itself included). <code>innerHtml</code> is the same, but it only looks at children of
the node.</p>
<pre><code>document.body.outerHtml;    // --&gt; &quot;&lt;body&gt;&lt;h1&gt;...&lt;/h1&gt;...&lt;/body&gt;&quot;
</code></pre>
      </section>
      <section class="pure-u-3-4 notes hw2 language-javascript"><h1 id="homework-2-xml-document-modeling">Homework 2: XML Document Modeling</h1>
<p>Due <em>Friday, February 14 at 9 PM</em> (note: not 9 AM).</p>
<p>Implementation stub available in the <a href="https://github.com/cis197s14/hw/blob/master/hw2/xml-model.js">homework repository</a>.</p>
<h2 id="before-starting-this-assignment">Before starting this assignment</h2>
<p>Install the sax.js library by running <code>npm install sax</code> in the root of your
homework directory. Also, add the line &quot;node_modules&quot; to your <code>.gitignore</code> file
in this same folder (this prevents libraries from being committed to the git
repository).</p>
<p>See <a href="http://www.mulberrytech.com/papers/fromHTMLtoXML/slide012.html">this page</a>
to understand the relationship between XML and HTML.</p>
<h2 id="modeling-xml-documents">Modeling XML documents</h2>
<p>In this assignment you&#39;re going to develop an API for working with XML
documents. Similar to how web browsers parse an HTML document (which is very
similar to XML in structure anyway) and produce the <strong>Document Object Model</strong>
for us to work with in JavaScript, the tool you produce will be able to take an
XML document (as a string) as input and generate a JavaScript object that can
inspect and filter the document tree.</p>
<p>First off, we ought to decide on a data structure to keep track of the XML nodes
found during parsing. Since this is an exercise in object-oriented JS, we&#39;ll
model XMLElements and the overall XMLDocument as objects.</p>
<p><strong><em>TODO</em></strong>: Define a JavaScript class (using prototypes) called <code>XMLElement</code>
with the following properties and methods. The sample values show the expected
representation for an XML node like
<code>&lt;question seq=&quot;1&quot;&gt;Who framed Roger Rabbit?&lt;/question&gt;</code>.</p>
<pre><code>{
  // Is this a document node or an element in the tree?
  type: &#39;element&#39;,

  // Name of the XML node
  name: &#39;question&#39;,

  // Hash of the node attributes
  attributes: { seq: 1 },

  /*
   * Array of child nodes. Publicly provided in the API to allow for
   * iteration over child nodes.
   */
  children: [ ... ],

  /*
   * Returns a list of nodes in this subtree that match the given `nodeName`
   * by doing a recursive lookup.
   */
  find: function (nodeName) { },

  /*
   * Returns a list of nodes in this subtree that have matching attributes
   * as provided by an input hash of attrs (names &amp; value pairs).
   * If a particular attribute value is not provided (is undefined), this
   * method should match simply on attribute names (whether certain nodes
   * have that attribute at all).
   */
  findWithAttribute: function (attrs) { }
}
</code></pre><p>These are not the only properties and methods allowed in the class; feel free to
add more as necessary for your implementation. If you define properties or
methods that you intend to be private (not part of the XML document object
model), it&#39;s good practice to signify this with an underscore <code>_</code> prefixed to
the property / method name. For example, you might define a <code>_setAttributes</code>
function on <code>XMLElement</code>s that takes a hash and updates the stored attributes
for a node.</p>
<p><strong><em>TODO</em></strong>: Define a class called <code>XMLText</code> that simply wraps a text string in
the XML tree. For example, the text inside <code>&lt;greeting&gt;Hello world!&lt;/greeting&gt;</code>
would be an <code>XMLText</code> object with the properties:</p>
<pre><code>{
  type: &#39;text&#39;,
  value: &#39;Hello world!&#39;
}
</code></pre><p>Here&#39;s an example of what the children array in
<code>&lt;xml&gt;Hello, &lt;who name=&quot;world&quot;&gt;world&lt;/who&gt;!&lt;/xml&gt;</code> would look like:</p>
<pre><code>children: [
  { type: &#39;text&#39;, value: &#39;Hello&#39; },       // XMLText
  { type: &#39;element&#39;, name: &#39;who&#39;, ... },  // XMLElement
  { type: &#39;text&#39;, value: &#39;!&#39; }            // XMLText
]
</code></pre><p><strong><em>TODO</em></strong>: Define another class called <code>XMLDocument</code> that inherits from
<code>XMLELement</code>. Ensure it has these additional properties / methods:</p>
<pre><code>{
  // Is this a document node or an element in the tree?
  type: &#39;document&#39;

  /*
   * Creates an XMLElement from a hash of params (structured in the same way
   * as the XMLElement class definition above):
   *
   * params = { name: &#39;answer&#39;, attributes: { seq: 1 }, children: [...] }
   *
   * This element should be appended to the children of the document.
   */
  createElement: function (params) { },

  /*
   * Similar to `createElement`, this generates an XMLText node and adds it
   * to the document.
   */
  createTextNode: function (string) { }
}
</code></pre><h2 id="generating-the-model">Generating the model</h2>
<p>To actually do the string parsing of the XML Document, we&#39;re going to be using
a library called <code>sax</code>. While understanding how a parser works is interesting on
its own, I&#39;ll leave this topic for another course.</p>
<p>This parser reads in an XML document and provides callback hooks for events
that occur during parsing. If you&#39;re not familiar with callbacks -- they are
a method of asynchronous control flow that allows you to define a function to be
run when an event occurs. Some resources for more information about callbacks:</p>
<ul>
<li><a href="https://www.dropbox.com/s/6y4etm6u3ho8zym/Screenshot%202014-02-07%2021.34.58.png">JS, The Good Parts</a></li>
<li><a href="http://recurial.com/programming/understanding-callback-functions-in-javascript/">Understanding Callback Functions in JS</a></li>
</ul>
<p>Parser events we are interested in are the following:</p>
<ul>
<li><code>onerror</code>: an error occurred in parsing; you should probably throw it.</li>
<li><code>opentag</code>: parsed an opening tag for a node, like <code>&lt;question&gt;</code></li>
<li><code>onclosetag</code>: parsed a closing tag for a node, like <code>&lt;/question&gt;</code></li>
<li><code>ontext</code>: parsed some raw text within a node</li>
<li><code>onattribute</code>: parsed a (name, value) pair for a node attribute</li>
</ul>
<p>See the <a href="https://github.com/isaacs/sax-js">sax.js documentation</a> for further
reference. We don&#39;t care about CDATA for this assignment (even though it&#39;s in
the XML standard).</p>
<p>Your implementation should decide what to do when each of these events occurs.
In the end, a single <code>XMLDocument</code> should be produced that models the whole
tree. You should be able to interact with the document object by invoking its
tree filtering methods.</p>
<p>I have provided some implementation already in the <code>XMLDocumentBuilder</code> class
that starts off the parser. The tricky part is to now fill in the parser
callback hooks in a way that builds a proper tree model. While parsing, it
would behoove you to keep track (with a reference in the document builder class)
of the current <strong>context</strong> of the parser, or where it is in the tree. You won&#39;t
get this information in the parser callback; simply the relevant information
that was just parsed.</p>
<h2 id="debugging">Debugging</h2>
<p>In the implementation stub, there are module exports set up for the <code>xml-model</code>
file. You are welcome to add more exports for testing. For example, if you set
up a testing function called <code>testModel</code>, your exports at the bottom of the file
might look like</p>
<pre><code>module.exports = {
  XMLElement: XMLElement,
  XMLDocument: XMLDocument,
  testModel: testModel
};
</code></pre><p>To run the file and load these exports into a node interpreter, use the
following commands (in the hw2 folder):</p>
<pre><code>bash-3.2$ node
node&gt; var xml = require(&#39;./xml-model&#39;);
node&gt; xml.testModel();
</code></pre><p>Working with the returned <code>XMLDocument</code> might be a little tricky since it is
only returned in a callback from <code>XMLDocumentBuilder</code>, so you could expose a
global object and attach the built <code>XMLDocument</code> to this object in the callback.
Something like this:</p>
<pre><code>var MY_MODEL = { };

var builder = new XMLDocumentBuilder(SAMPLE_XML, function (doc) {
  MY_MODEL.doc = doc;
});

// -------------------------

module.exports = {
  model: MY_MODEL
};
</code></pre><p>Also, if you&#39;re feeling adventurous, you could learn about the
<a href="http://nodejs.org/api/debugger.html">node debugger</a>
(related: <a href="https://github.com/node-inspector/node-inspector">node-inspector</a>).</p>

      </section>
    </div>
  </body>
  <script type="text/javascript" src="build/javascripts/main-optimized.min.js"></script>
  <script type="text/javascript" src="build/javascripts/vendor/prism.min.js"></script>
</html>